language: python
services:
- docker
python:
- '3.6'
before_script:
- export LOCAL_POSTGRES_PORT_RANGE=5432
- docker-compose build
script:
- docker-compose run --rm web bash -c "python postgres_ready.py && ./manage.py migrate
  && ./manage.py test"
after_success:
- docker login --username="daniel.brownell@gmail.com" --password="$HEROKU_AUTH_TOKEN" registry.heroku.com
- docker tag web registry.heroku.com/bucketreactor/web
- docker push registry.heroku.com/bucketreactor/web
notifications:
  email: true
cache:
  pip: true
deploy:
  provider: heroku
  api_key:
    secure: otiuEVt82LWOwRSKQSVwDF2mNUApS7LSTWdknZoF9On+RBjgA6qMdZLH1uZ7GM3KbEhmxm2F6xUyv0aqLoMcNGwIA1Z3jSFN3y56Qf9Cdt8iBlOOOJjQGbvYnkw+UepOZnI2Njy2I1v0JhBO8gJFyXJbZMIFI2CuBfgsy+UYfYFOdCa+aLiGPTnL9PY5RNLDx7MPl+58RQIfASPdfNMTAhxiKvysJeS42TBWdN5DKDpEC0o7jkGtc60bDbvc9u8OtaLUyVva8H8zWRyPBDnTVihRhhkNbcOnmE2MffAPVsUjDRNPTh03PNSKQzvC+AuHAppZYeQPmE3q8OX00tz5AGeFPzcJWlCFKy2JrUonnie4msRhE9eCBwFuZlHrkuumbNaaBwZVRNCGY+GNoqwPeXlduB71mJMtWD0A6oj4Pjat8NtX+3j7XFowaPx5LNwojyDIP2dvb/+36uq8pxl2Cd7gSg7Z+mNmYC1JHiNNulUY9Eqo00zjQti6bIAGtppKBJbLcA5NQzSLQ+6ZiQgrq9u3stqOlcxjilPorHpEFfqBJ4ZUihfN3eQ4pYuIqVQ67ueRACmFmXhch5k2BO9X13jFeO/qPTdll2XRndAYMIIMZENdV/6nXVpiaYppuraxskcRqKV98OTW+OrUR51MeIaFq+59d7OYDwgYh8Jy+j0=
